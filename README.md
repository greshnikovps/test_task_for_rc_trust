
# Iris Neural Network and Verification

This project contains code for training a neural network on the Iris dataset and verifying its robustness using Z3. The code can be run in two ways: as `.ipynb` Notebook (recomended) or as `.py` scripts. There are instractions about both ways below.

## Prerequisites

Make sure you have Python 3.x installed on your system. In case you want run the code as notebook, Jupyter Notebook (https://jupyter.org/) should be installed or Google Colab (https://colab.research.google.com/) should be set up. 

## Installation

### Jupyter Notebook

To run the code in a Jupyter Notebook, open your notebook and execute the following command (it is already added in .ipynb notebook) in a cell to install the necessary packages:

```python
!pip install torch scikit-learn onnx onnx2torch onnxruntime z3-solver
```

### Running as `.py` Scripts

1. Clone the repository or download the `.py` scripts.
2. Install the required dependencies by running:

   ```bash
   pip install -r requirements.txt
   ```

## Running the Code

### Jupyter Notebook

1. Open the Jupyter Notebook where the code is located.
2. Run all the cells to train the neural network and verify its robustness.

### `.py` Scripts

1. After installing the dependencies, you can run the training script using:

   ```bash
   python train_iris.py
   ```

   This will train the neural network and export it as an ONNX model.

2. Next, run the verification script using:

   ```bash
   python verify_iris.py
   ```

   This will verify the robustness of the trained neural network using Z3.

## Structure

- `iris_nn_verification_notebook.ipynb`: Notebook for training and verifying the model.
- `train_iris.py`: Script for training the neural network on the Iris dataset and exporting it as an ONNX model.
- `verify_iris.py`: Script for verifying the robustness of the trained model using Z3.
- `requirements.txt`: List of required packages for running the code.
- `README.md`: Documentation for the project.
- `Task`: The task.

## Notes

- Make sure the ONNX model generated by `train_iris.py` is located in the same directory as `verify_iris.py` before running the verification script.
- The verification process might take some time (1-2 minutes).
